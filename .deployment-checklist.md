# Deployment Checkliste - IONOS

## Vor dem Upload

### 1. Konfiguration anpassen
- [ ] `config.php`: DEBUG_MODE auf `false` setzen
- [ ] `config.php`: Datenbank-Credentials für IONOS eintragen
- [ ] `config.php`: APP_URL auf Production-Domain ändern
- [ ] `config.php`: GOOGLE_REDIRECT_URI auf Production-URL ändern

### 2. Sensible Dateien schützen
- [ ] `.htaccess` Datei erstellen für Schutz von `/credentials/`
- [ ] `.htaccess` für `/database/` und `/logs/`
- [ ] Teste ob `/credentials/` nicht öffentlich zugänglich ist

### 3. Datenbank
- [ ] MySQL Datenbank bei IONOS erstellen
- [ ] Datenbankname, User, Passwort notieren
- [ ] Schema importieren: `database/schema.sql`
- [ ] Migrationen ausführen: `database/migrations/*.sql`
- [ ] Admin-User erstellen

### 4. Google Calendar OAuth
- [ ] In Google Cloud Console: Authorized redirect URIs aktualisieren
- [ ] Production Domain hinzufügen (z.B. https://booking.bremerpresseclub.de/oauth-callback.php)
- [ ] Credentials auf Server hochladen

### 5. Verzeichnisse und Rechte
- [ ] `/logs/` Verzeichnis erstellen (777 oder 755 mit Apache-Owner)
- [ ] `/credentials/` Verzeichnis erstellen (755)
- [ ] `/uploads/` falls verwendet (755)

## Upload-Methoden

### Option A: FTP/SFTP (Empfohlen für Erstinstallation)
1. FileZilla oder ähnliches Tool verwenden
2. Mit IONOS SFTP-Zugangsdaten verbinden
3. Alle Dateien AUSSER `/credentials/google-calendar-credentials.json` hochladen
4. Credentials separat hochladen nach erstem OAuth-Durchlauf

### Option B: Git Deploy (Empfohlen für Updates)
1. Git Repository erstellen (ohne sensible Daten)
2. `.gitignore` erstellen
3. SSH-Zugang bei IONOS einrichten
4. Git clone auf Server
5. Credentials manuell hochladen

## Nach dem Upload

### 1. Dateirechte prüfen
```bash
chmod 755 /pfad/zum/projekt
chmod 644 *.php
chmod 755 credentials/
chmod 600 credentials/*.json
chmod 755 logs/
```

### 2. .htaccess erstellen
Siehe separate Datei: `.htaccess-production`

### 3. Testen
- [ ] Startseite lädt: https://ihre-domain.de
- [ ] Raumauswahl funktioniert
- [ ] Kalender zeigt Events
- [ ] Admin-Login funktioniert
- [ ] Google OAuth funktioniert
- [ ] Testbuchung durchführen
- [ ] E-Mail-Versand testen

### 4. Google Calendar neu autorisieren
1. Alte Credentials löschen/umbenennen
2. `/oauth-start.php` im Browser aufrufen
3. Google Autorisierung durchlaufen
4. Prüfen ob `/credentials/google-calendar-credentials.json` erstellt wurde

## Sicherheit

### 1. PHP-Einstellungen
- [ ] `display_errors = Off` in php.ini
- [ ] `error_reporting = E_ALL` (nur Logging)
- [ ] `expose_php = Off`

### 2. Datenbank
- [ ] Separater DB-User nur für diese App
- [ ] Minimale Rechte (SELECT, INSERT, UPDATE, DELETE)
- [ ] Keine GRANT, DROP, CREATE Rechte

### 3. Backups einrichten
- [ ] Tägliches Datenbank-Backup
- [ ] Wöchentliches Datei-Backup
- [ ] Backup-Restore testen

## Troubleshooting

### Häufige Fehler
1. **500 Internal Server Error**: PHP-Version prüfen (min. 8.0)
2. **Google OAuth Fehler**: Redirect URI in Google Console prüfen
3. **Keine Events**: Kalender-IDs und Berechtigungen prüfen
4. **E-Mails kommen nicht an**: SMTP-Einstellungen prüfen

### Logs prüfen
- PHP Error Log: meist in `/logs/` oder über IONOS Control Panel
- Application Log: `/logs/app.log`
- Apache Error Log: über IONOS Control Panel

## Kontakt-Informationen
- IONOS Support: https://www.ionos.de/hilfe/
- Google Cloud Console: https://console.cloud.google.com/
